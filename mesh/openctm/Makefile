
#Makefile generated by genmake.py (http://goanna.cs.rmit.edu.au/~pknowles/scripts.php)
#Known Bugs: Not all source files/headers of sublibs (projects with their own
#makefile in subdirectories) are searched. Hence, the external library prediction
#does not always get all results

#check x64
ASFX=
LBITS := $(shell getconf LONG_BIT)
ifeq ($(LBITS),64)
ASFX=64
endif

NOOP = @$(SHELL) -c true

.PHONY=all,debug,prof,opt,clean,cleaner,echodeps
TARGET=libopenctm$(ASFX).a
CC=gcc
LD=ar
CFLAGS_R?=
CFLAGS= -I. $(CFLAGS_R) -Wno-unused-parameter -Wno-unused-but-set-variable -Wall -Wextra -D_GNU_SOURCE -Wfatal-errors
LFLAGS= -rcs 
SUBLIBS= 
OBJECTS= ./compressMG2.o ./compressRAW.o ./stream.o ./LzFind.o ./LzmaEnc.o ./compressMG1.o ./Alloc.o ./LzmaDec.o ./LzmaLib.o ./openctm.o

all:  $(TARGET)

debug: CFLAGS+= -g
debug: export CFLAGS_R+= -g
debug: all

prof: CFLAGS+= -pg
prof: export CFLAGS_R+= -pg
prof: all

opt: CFLAGS+= -03
opt: export CFLAGS_R+= -03
opt: all

ALL_SUBLIBS= $(SUBLIBS)


#prints a list of library dependencies recursively
echodeps:
	@echo $(ALL_SUBLIBS)


#linking/archiving the target
$(TARGET): $(SUBLIBS) $(OBJECTS)
	@echo linking $(TARGET)
	@$(LD) -o $(TARGET) $(OBJECTS) $(ALL_SUBLIBS) $(LFLAGS)

#compile object files
%.o : %.c
	@echo compiling $@ $(CFLAGS_R)
	@$(CC) $(CFLAGS) -c $< -o $@

#object dependencies
./compressMG2.o: compressMG2.c openctm.h openctmpp.h internal.h
./compressRAW.o: compressRAW.c openctm.h openctmpp.h internal.h
./stream.o: stream.c openctm.h openctmpp.h internal.h
./LzFind.o: LzFind.c LzHash.h LzFind.h Types.h NameMangle.h
./LzmaEnc.o: LzmaEnc.c NameMangle.h Types.h LzFind.h LzmaEnc.h
./compressMG1.o: compressMG1.c openctm.h openctmpp.h internal.h
./Alloc.o: Alloc.c NameMangle.h Alloc.h
./LzmaDec.o: LzmaDec.c NameMangle.h Types.h LzmaDec.h
./LzmaLib.o: LzmaLib.c NameMangle.h Types.h LzmaLib.h LzmaDec.h Alloc.h LzmaEnc.h
./openctm.o: openctm.c openctm.h openctmpp.h internal.h

#clean and cleaner
clean:
	@echo cleaning $(TARGET)
	@rm -f $(OBJECTS)
	@rm -f $(TARGET)
cleaner: clean










